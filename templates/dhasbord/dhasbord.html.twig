{% extends 'base.html.twig' %}

{% block title %}Dashboard{% endblock %}

{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('css/style2.css') }}">
    <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css">
    <style>
    
.card_biblo {
  display: flex;
  height: 280px;
  width: 200px;
  background-color: #1a3b5d; /* Dark Blue */
  border-radius: 10px;
  box-shadow: -1rem 0 3rem rgba(0, 0, 0, 0.25);
  margin-left: -80px;
  transition: 0.4s ease-out;
  position: relative;
  left: 0px;
}

.card_biblo:not(:first-child) {
  margin-left: -50px;
}

.card_biblo:hover {
  transform: translateY(-20px);
  transition: 0.4s ease-out;
  text-shadow: 2px 2px 8px #3a6ea5; /* Light Blue Glow */
}

.card_biblo:hover ~ .card {
  position: relative;
  left: 50px;
  transform: rotateX(-15deg) rotateY(10deg);
  transition: 0.4s ease-out;
}

/* Title */
.title-1 {
  color: #ffffff;
  font-size: 28px;
  font-weight: 800;
  position: absolute;
  left: 20px;
  top: 15px;
}

/* Button */
.btn {
  position: absolute;
  top: 195px;
  margin: 0 20px;
  width: 120px;
  height: 32px;
  border-radius: 8px;
  border: none;
  background-color: #2978b5; /* Medium Blue */
  color: #fff;
  transition: 0.4s ease-out;
}

.btn:hover {
  transition: 0.4s ease-out;
  background-color: #62b6cb; /* Light Blue */
  color: #ffffff;
  box-shadow: 0px 0px 20px rgba(98, 182, 203, 0.5),
    0px 5px 5px -1px rgba(57, 139, 189, 0.25),
    inset 4px 4px 8px rgba(98, 182, 203, 0.5),
    inset -4px -4px 8px rgba(28, 93, 166, 0.35);
}

/* Progress Bar */
.bar {
  position: relative;
  top: 250px;
  height: 5px;
  width: 100%;
}

.emptybar {
  background-color: #142f4d; /* Darker Blue */
  width: 100%;
  height: 100%;
}

.filledbar {
  position: absolute;
  top: 0px;
  z-index: 3;
  width: 0px;
  height: 100%;
  background: linear-gradient(90deg, #2978b5, #62b6cb 100%);
  transition: 0.6s ease-out;
}

.card:hover .filledbar {
  width: 100%;
  transition: 0.4s ease-out;
}

/* Content */
.content {
  position: absolute;
  padding: 20px;
  top: 60px;
  color: #dbe9f4; /* Light Blue-Gray */
  font-size: 0.7rem;
}

/* Stroke Effect */
.stroke {
  stroke: white;
  stroke-dasharray: 360;
  stroke-dashoffset: 360;
  transition: 0.6s ease-out;
}

.card_biblo:hover .stroke {
  stroke-dashoffset: 100;
  transition: 0.6s ease-out;
}
/* Style the Select Dropdown */
select {
  width: 100%;
  padding: 10px;
  font-size: 14px;
  border: 2px solid #4070f4;
  border-radius: 8px;
  background-color: white;
  color: #333;
  outline: none;
  transition: all 0.3s ease-in-out;
  cursor: pointer;
}
/* Style du logo */
.resized-logoimage {
  width: 50px;
  height: 50px;
  object-fit: cover;
  border-radius: 50%;
}
       .cards-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
            align-items: flex-start;
            padding: 20px;
        }

        .main-content {
            margin-left: 250px;
            padding: 20px;
            width: calc(100% - 250px);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .form-container {
            max-width: 600px;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
        }
    </style>
{% endblock %}

{% block javascripts %}
    <script src="{{ asset('js/script2.js') }}" defer></script>
{% endblock %}

{% block body %}
    <!-- ✅ Sidebar Navigation -->
    	<section id="sidebar">
		<div class="logo_items flex">
            <span class="nav_image">
                <img src="{{ asset('image/logo.png') }}" alt="Logo" class="resized-logoimage">
            </span>
            <span class="logo_name">Edu9raya</span>
		<ul class="side-menu top">
			<li class="active">
				<a href="#">
					<i class='bx bxs-dashboard' ></i>
					<span class="text">Dashboard</span>
				</a>
			</li>
			<li>
				<a href="{{ path('table_book') }}">
					<i class='bx bxs-shopping-bag-alt' ></i>
					<span class="text">My books</span>
				</a>
			</li>
			<li>
				<a href="{{ path('list_categorie') }}">
					<i class='bx bxs-doughnut-chart' ></i>
					<span class="text">List categoories</span>
				</a>
			</li>
			<li>
				<a href="{{ path('app_ajjouter') }}">
					<i class='bx bxs-message-dots' ></i>
					<span class="text">Ajjouter Books</span>
				</a>
			</li>
			<li>
				<a href="{{ path('add_categorie') }}">
					<i class='bx bxs-group' ></i>
					<span class="text">Ajjouter Categories</span>
				</a>
			</li>
		</ul>
		<ul class="side-menu">
			<li>
				<a href="#">
					<i class='bx bxs-cog' ></i>
					<span class="text">Settings</span>
				</a>
			</li>
			<li>
				<a href="#" class="logout">
					<i class='bx bxs-log-out-circle' ></i>
					<span class="text">Logout</span>
				</a>
			</li>
		</ul>
	</section>
	<!-- SIDEBAR -->


<script>

document.addEventListener("DOMContentLoaded", function () {
    const searchForm = document.getElementById("searchForm");
    const searchInput = document.getElementById("searchBook");

    if (!searchForm || !searchInput) {
        console.error("❌ Formulaire ou champ de recherche introuvable !");
        return;
    }

    searchForm.addEventListener("submit", function (event) {
        event.preventDefault(); // Empêche l'envoi classique du formulaire

        const bookName = searchInput.value.trim();
        if (!bookName) {
            alert("Veuillez entrer le nom d'un livre !");
            return;
        }

        console.log("🔍 Recherche en cours pour :", bookName);

        fetch(`/search-book?name=${encodeURIComponent(bookName)}`)
            .then(response => response.json())
            .then(data => {
                if (data.found) {
                    console.log("✅ Livre trouvé, redirection vers :", data.url);
                    window.location.href = data.url; // 🔥 Redirige vers la page du livre trouvé
                } else {
                    console.log("❌ Livre non trouvé !");
                    alert("❌ Livre non trouvé !");
                    window.location.href = "/not-found";; // 🔥 Redirige vers une page 404
                }
            })
            .catch(error => console.error("🚨 Erreur lors de la recherche :", error));
    });
});


</script>
	<!-- CONTENT -->
	<section id="content">
		<!-- NAVBAR -->
		<nav>
			<i class='bx bx-menu' ></i>
			<a href="#" class="nav-link">List</a>
<form id="searchForm" action="#" method="GET">
    <div class="form-input">
        <input type="search" id="searchBook" name="name" placeholder="Rechercher un livre..." required>
        <button type="submit" class="search-btn">
            <i class='bx bx-search'></i>
        </button>
    </div>
</form>



			<input type="checkbox" id="switch-mode" hidden>
			<label for="switch-mode" class="switch-mode"></label>
			<a href="#" class="notification">
				<i class='bx bxs-bell' ></i>
				<span class="num">8</span>
			</a>
			<a href="#" class="profile">
				<img src="img/people.png">
			</a>
		</nav>
		<!-- NAVBAR -->

		<!-- MAIN -->
		<main>
			<div class="head-title">
				<div class="left">
					<h1>Dashboard</h1>
					<ul class="breadcrumb">
						<li>
							<a href="#">Dashboard</a>
						</li>
						<li><i class='bx bx-chevron-right' ></i></li>
						<li>
							<a class="active" href="#">Home</a>
						</li>
					</ul>
				</div>
		
		</main>
	
	

        <h1>Tableau de bord</h1>
        <div class="cards-container">
            {% for book in books %}
                <div class="card_biblo">
                    <div class="title-1">{{ book.nomBook }}</div>
                    <div class="content">
                        <strong>Special id</strong> {{ book.idBook }} <br>
                        <strong>Disponible:</strong> {{ book.dispoBook }}
                    </div>
                    <a href="{{ path('book_detail', { 'id': book.id }) }}"><button class="btn">Voir plus</button></a>
                    <div class="bar">
                        <div class="emptybar"></div>
                        <div class="filledbar"></div>
                    </div>
                </div>
            {% else %}
                <p>Aucun livre trouvé.</p>
            {% endfor %}


        </div>
    </div>
    </section>
{% endblock %}
